import{h as se,at as oe,aw as re,au as le,ay as ue,t as K,l as D,T as ie,m as ce,P as W,ba as de,aG as Q,aC as $,aB as j,n as ve,bd as pe,Z as _e,Y as Z,aP as V,_ as I,f as d,v as b,g as J,o as C,c as y,w as f,M as q,U as B,ai as X,e as A,a as v,Q as P,a8 as x,a9 as S,L as E,ao as L,a6 as N,aZ as G,S as g,aj as T,d as w,W as ee,K as te,be as R,bf as H,bg as fe,bh as me,bi as he}from"./index.8d354e65.js";import{Q as ge,a as Ce,_ as we}from"./NewPostForm.1837ee6e.js";import{h as z,l as ye,m as F,b as be,c as ke}from"./ClosePopup.e4e7496c.js";import{u as Y}from"./use-quasar.879ae5ba.js";var U=se({name:"QInnerLoading",props:{...oe,...re,showing:Boolean,color:String,size:{type:[String,Number],default:42},label:String,labelClass:String,labelStyle:[String,Array,Object]},setup(o,{slots:a}){const e=ce(),u=le(o,e.proxy.$q),{transitionProps:s,transitionStyle:c}=ue(o),h=K(()=>"q-inner-loading q--avoid-card-border absolute-full column flex-center"+(u.value===!0?" q-inner-loading--dark":"")),t=K(()=>"q-inner-loading__label"+(o.labelClass!==void 0?` ${o.labelClass}`:""));function n(){const _=[D(W,{size:o.size,color:o.color})];return o.label!==void 0&&_.push(D("div",{class:t.value,style:o.labelStyle},[o.label])),_}function l(){return o.showing===!0?D("div",{class:h.value,style:c.value},a.default!==void 0?a.default():n()):null}return()=>D(ie,s.value,l)}});const ae={esc:27,tab:9,enter:13,space:32,up:38,left:37,right:39,down:40,delete:[8,46]},Se=new RegExp(`^([\\d+]+|${Object.keys(ae).join("|")})$`,"i");function xe(o,a){const{top:e,left:u}=V(o);return Math.abs(u-a.left)>=7||Math.abs(e-a.top)>=7}var ne=de({name:"touch-repeat",beforeMount(o,{modifiers:a,value:e,arg:u}){const s=Object.keys(a).reduce((n,l)=>{if(Se.test(l)===!0){const _=isNaN(parseInt(l,10))?ae[l.toLowerCase()]:parseInt(l,10);_>=0&&n.push(_)}return n},[]);if(a.mouse!==!0&&Q.has.touch!==!0&&s.length===0)return;const c=typeof u=="string"&&u.length!==0?u.split(":").map(n=>parseInt(n,10)):[0,600,300],h=c.length-1,t={keyboard:s,handler:e,noop:ve,mouseStart(n){t.event===void 0&&typeof t.handler=="function"&&pe(n)===!0&&($(t,"temp",[[document,"mousemove","move","passiveCapture"],[document,"click","end","notPassiveCapture"]]),t.start(n,!0))},keyboardStart(n){if(typeof t.handler=="function"&&_e(n,s)===!0){if((c[0]===0||t.event!==void 0)&&(Z(n),o.focus(),t.event!==void 0))return;$(t,"temp",[[document,"keyup","end","notPassiveCapture"],[document,"click","end","notPassiveCapture"]]),t.start(n,!1,!0)}},touchStart(n){if(n.target!==void 0&&typeof t.handler=="function"){const l=n.target;$(t,"temp",[[l,"touchmove","move","passiveCapture"],[l,"touchcancel","end","notPassiveCapture"],[l,"touchend","end","notPassiveCapture"]]),t.start(n)}},start(n,l,_){_!==!0&&(t.origin=V(n));function p(r){t.styleCleanup=void 0,document.documentElement.style.cursor="";const m=()=>{document.body.classList.remove("non-selectable")};r===!0?(z(),setTimeout(m,10)):m()}Q.is.mobile===!0&&(document.body.classList.add("non-selectable"),z(),t.styleCleanup=p),t.event={touch:l!==!0&&_!==!0,mouse:l===!0,keyboard:_===!0,startTime:Date.now(),repeatCount:0};const i=()=>{if(t.timer=void 0,t.event===void 0)return;t.event.repeatCount===0&&(t.event.evt=n,_===!0?t.event.keyCode=n.keyCode:t.event.position=V(n),Q.is.mobile!==!0&&(document.documentElement.style.cursor="pointer",document.body.classList.add("non-selectable"),z(),t.styleCleanup=p)),t.event.duration=Date.now()-t.event.startTime,t.event.repeatCount+=1,t.handler(t.event);const r=h<t.event.repeatCount?h:t.event.repeatCount;t.timer=setTimeout(i,c[r])};c[0]===0?i():t.timer=setTimeout(i,c[0])},move(n){t.event!==void 0&&t.timer!==void 0&&xe(n,t.origin)===!0&&(clearTimeout(t.timer),t.timer=void 0)},end(n){t.event!==void 0&&(t.styleCleanup!==void 0&&t.styleCleanup(!0),n!==void 0&&t.event.repeatCount>0&&Z(n),j(t,"temp"),t.timer!==void 0&&(clearTimeout(t.timer),t.timer=void 0),t.event=void 0)}};if(o.__qtouchrepeat=t,a.mouse===!0){const n=a.mouseCapture===!0||a.mousecapture===!0?"Capture":"";$(t,"main",[[o,"mousedown","mouseStart",`passive${n}`]])}if(Q.has.touch===!0&&$(t,"main",[[o,"touchstart","touchStart",`passive${a.capture===!0?"Capture":""}`],[o,"touchend","noop","passiveCapture"]]),s.length!==0){const n=a.keyCapture===!0||a.keycapture===!0?"Capture":"";$(t,"main",[[o,"keydown","keyboardStart",`notPassive${n}`]])}},updated(o,{oldValue:a,value:e}){const u=o.__qtouchrepeat;u!==void 0&&a!==e&&(typeof e!="function"&&u.end(),u.handler=e)},beforeUnmount(o){const a=o.__qtouchrepeat;a!==void 0&&(a.timer!==void 0&&clearTimeout(a.timer),j(a,"main"),j(a,"temp"),a.styleCleanup!==void 0&&a.styleCleanup(),delete o.__qtouchrepeat)}});const Pe={key:0,class:"text-center stars"},$e={key:1,class:"center absoulte-center q-pt-sm"},Te={__name:"PostCard",props:{post_id:String,post_text:String,starCount:Number,index:Number,loading:{type:Boolean,default:!0}},setup(o){const a=d(0),e=o;return b(()=>e.starCount,u=>{a.value=u}),J(()=>{}),(u,s)=>(C(),y(E,{class:"post-card"},{default:f(()=>[e.loading?A("",!0):(C(),q("div",Pe,[(C(!0),q(B,null,X(a.value,c=>(C(),y(ge,{key:c,size:"lg","text-color":"white",icon:"star"}))),128))])),e.loading?A("",!0):(C(),q("div",$e,[v(P,{class:"flex-center"},{default:f(()=>[x(S(e.post_text),1)]),_:1})])),v(U,{showing:e.loading,class:"bg-accent"},{default:f(()=>[v(W,{thickness:10,size:"50px",color:"pithee"})]),_:1},8,["showing"])]),_:1}))}};var M=I(Te,[["__scopeId","data-v-ae34d4d0"]]);const qe=o=>(R("data-v-bd54bfe2"),o=o(),H(),o),Ie={class:"bottom-row row card-container"},Me={class:"left-column col q-pa-sm"},De={class:"top-left q-pb-sm"},Qe={class:"bottom-left"},Ae={class:"right-column col q-pa-sm"},We={class:"top-right q-pb-sm"},Be={class:"bottom-right"},Le=qe(()=>g("div",{class:"row justify-center",style:{width:"50%","margin-right":"auto","margin-left":"auto"}},null,-1)),Ne={__name:"CardGrid",setup(o){Y();const a=d(0),e=L(),u=d(!0),s=d([]),c=d(null),h=d();b(()=>e.getArchiveShow,p=>{u.value=!p}),b(()=>e.getCurrentPosts,p=>{s.value=p}),N(()=>{s.value=e.getCurrentPosts,h.value=e.getCurrentWinner}),G(()=>{s.value=e.getCurrentPosts,h.value=e.getCurrentWinner});async function t(p){e.noClick=!0,await e.runShowdown(p),s.value=e.getCurrentPosts,e.noClick=!1}async function n(p,i){e.noClick=!0,c.value=i,s.value[i].starCount++,s.value.forEach((r,m)=>{s.value[i].starCount<3?m!=i&&(r.loading=!0):r.loading=!0}),await e.select(p),e.noClick=!1}async function l(){e.noClick=!0,s.value.forEach((p,i)=>{p.loading=!0}),await e.shufflePosts(),e.noClick=!1}function _({evt:p,...i}){if(a.value=i.repeatCount,i.repeatCount===3){l(),a.value=0;return}console.log(p)}return(p,i)=>(C(),q(B,null,[g("div",Ie,[g("div",Me,[g("div",De,[v(M,T(s.value[0],{onClick:i[0]||(i[0]=r=>w(e).isShowdown?t(s.value[0]):n(s.value[0],0)),class:[w(e).noClick?"noclick":"","p-card"]}),null,16,["class"])]),g("div",Qe,[v(M,T(s.value[1],{onClick:i[1]||(i[1]=r=>w(e).isShowdown?t(s.value[1]):n(s.value[1],1)),class:[w(e).noClick?"noclick":"","p-card"]}),null,16,["class"])])]),g("div",Ae,[g("div",We,[v(M,T(s.value[2],{onClick:i[2]||(i[2]=r=>w(e).isShowdown?t(s.value[2]):n(s.value[2],2)),class:[w(e).noClick?"noclick":"","p-card"]}),null,16,["class"])]),g("div",Be,[v(M,T(s.value[3],{onClick:i[3]||(i[3]=r=>w(e).isShowdown?t(s.value[3]):n(s.value[3],3)),class:[w(e).noClick?"noclick":"","p-card"]}),null,16,["class"])])])]),ee((C(),y(te,{onMouseup:i[4]||(i[4]=r=>a.value=0),onMouseleave:i[5]||(i[5]=r=>a.value=0),class:"full-width",color:"accent"},{default:f(()=>[x(S(a.value<1?"Hold to Shuffle":a.value),1)]),_:1})),[[ne,_,"1:1000:1000",{mouse:!0}]]),Le],64))}};var je=I(Ne,[["__scopeId","data-v-bd54bfe2"]]);const ze=o=>(R("data-v-5d44ea1c"),o=o(),H(),o),Ve=ze(()=>g("div",{class:"row justify-center",style:{width:"50%","margin-right":"auto","margin-left":"auto"}},null,-1)),Ee={__name:"CardTable",setup(o){Y();const a=d(0),e=L(),u=d(!0),s=d([]);d();const c=d(!0);d(!0);const h=d(null);d(!1);const t=d(),n=[{name:"card",required:!0,align:"left",field:r=>r.post_text,format:r=>`${r}`,sortable:!1}];b(()=>e.getArchiveShow,r=>{u.value=!r}),b(()=>e.getCurrentPosts,r=>{s.value=r}),N(()=>{s.value=e.getCurrentPosts,t.value=e.getCurrentWinner}),G(()=>{s.value=e.getCurrentPosts,t.value=e.getCurrentWinner});async function l(r){e.noClick=!0,await e.runShowdown(r),s.value=e.getCurrentPosts,e.noClick=!1}async function _(r){e.noClick=!0,h.value=r.index,s.value[r.index].starCount++,s.value.forEach((m,k)=>{s.value[r.index].starCount<3?k!=r.index&&(m.loading=!0):m.loading=!0}),await e.select(r),e.noClick=!1}async function p(){e.noClick=!0,s.value.forEach((r,m)=>{r.loading=!0}),await e.shufflePosts(),e.noClick=!1}function i({evt:r,...m}){if(a.value=m.repeatCount,m.repeatCount===3){p(),a.value=0;return}console.log(r)}return(r,m)=>(C(),q(B,null,[v(ye,{flat:"",bordered:"",rows:s.value,columns:n,"row-key":"index","hide-header":"",grid:c.value},{item:f(k=>[v(M,T(k.row,{onClick:O=>w(e).isShowdown?l(k.row):_(k.row),class:["p-card q-my-xs center",[w(e).noClick?"noclick":"","p-card","q-my-xs","center"]]}),null,16,["onClick","class"])]),bottom:f(()=>[ee((C(),y(te,{onMouseup:m[0]||(m[0]=k=>a.value=0),onMouseleave:m[1]||(m[1]=k=>a.value=0),class:"full-width",color:"accent"},{default:f(()=>[x(S(a.value<1?"Hold to Shuffle":a.value),1)]),_:1})),[[ne,i,"1:1000:1000",{mouse:!0}]])]),_:1},8,["rows","grid"]),Ve],64))}};var Ge=I(Ee,[["__scopeId","data-v-5d44ea1c"]]);const Re={__name:"ArchiveCard",props:{player_name:String,post_text:String,won_at:String},setup(o){function a(){return u(e.won_at)}const e=o;function u(s){return fe.formatDate(s,"MM-DD-YYYY @ HH:mm A ").toLocaleString()}return(s,c)=>(C(),y(E,{class:"my-card q-my-xs"},{default:f(()=>[v(P,null,{default:f(()=>[x(S(e.post_text),1)]),_:1}),v(P,null,{default:f(()=>[x(S(e.player_name),1)]),_:1}),v(P,null,{default:f(()=>[x(S(a()),1)]),_:1})]),_:1}))}};var He=I(Re,[["__scopeId","data-v-3816f865"]]);const Ye={class:"center q-ma-xs"},Ue={class:"text-center q-pt-sm"},Oe={__name:"TopCard",props:{player_name:String,post_text:String,won_at:String,loading:{type:Boolean,default:!0}},setup(o){const a=L(),e=d("--:--"),u=d(6e5),s=d(!1),c=d([]),h=o;b(()=>a.getWinnerArchive,n=>{console.log(n),console.log("archive updated!"),c.value=n}),J(()=>{}),N(()=>{t(),c.value=a.getWinnerArchive});async function t(){const n=new Date(h.won_at),l=new Date(n);l.setMinutes(l.getMinutes()+10);async function _(){s.value=!0,await a.fetchWinner(),l.setMinutes(l.getMinutes()+10),clearInterval(p),s.value=!1,t()}const p=setInterval(async function(){let i=Date.now();var r=l-i,m=Math.floor(r%(1e3*60*60)/(1e3*60)),k=String(Math.floor(r%(1e3*60)/1e3)).padStart(2,"0");u.value=r/6e5;const O=m+":"+k;e.value=O,r<0&&(clearInterval(p),await _())},1e3)}return(n,l)=>(C(),y(E,{class:"my-card flex-center btn--no-hover",ripple:!1},{default:f(()=>[g("div",Ye,[v(P,{class:"flex-center card-text"},{default:f(()=>[x(S(h.post_text),1)]),_:1})]),v(P,{class:"name"},{default:f(()=>[g("div",Ue,S(h.player_name),1)]),_:1}),v(P,{class:"text-center"},{default:f(()=>[x(S(u.value<0?"--:--":e.value)+" ",1),g("div",null,[v(F,{"instant-feedback":"","animation-speed":"100",value:u.value,color:"pithee",class:"absolute-bottom-left",reverse:"",style:{"max-width":"50%"}},null,8,["value"]),v(F,{"instant-feedback":"","animation-speed":"100",value:u.value,color:"pithee",class:"absolute-bottom-right",style:{"max-width":"50%"}},null,8,["value"])])]),_:1}),v(be,{fit:"",anchor:"bottom middle",self:"top middle",style:{"background-color":"transparent"},onBeforeHide:l[0]||(l[0]=_=>w(a).archiveShow=!1),onBeforeShow:l[1]||(l[1]=_=>w(a).archiveShow=!0),"transition-show":"jump-down","transition-hide":"jump-up",class:"no-shadow"},{default:f(()=>[(C(!0),q(B,null,X(c.value,(_,p)=>(C(),y(ke,{key:p,class:"menu center"},{default:f(()=>[(C(),y(He,T(_,{key:p}),null,16))]),_:2},1024))),128))]),_:1}),v(U,{showing:s.value,class:"bg-accent"},{default:f(()=>[v(W,{thickness:10,size:"50px",color:"pithee"})]),_:1},8,["showing"])]),_:1}))}};var Ke=I(Oe,[["__scopeId","data-v-b129bf62"]]);const Ze=o=>(R("data-v-a9cf4904"),o=o(),H(),o),Fe={class:"grid-container"},Je={class:"top-row row q-pa-sm"},Xe=Ze(()=>g("div",{class:"top-card",style:{"margin-left":"auto","margin-right":"auto"}},null,-1)),et={class:"gt-xs"},tt={class:"lt-sm"},at={__name:"GamePage",setup(o){const a=L(),e=Y(),u=d([]),s=d(!1),c=d(),h=d(!0),t=d(!0);return b(()=>a.getCurrentPosts,n=>{u.value=n}),b(()=>a.getCurrentWinner,n=>{c.value=n}),b(()=>a.getArchiveShow,n=>{h.value=!n}),b(()=>e.screen,n=>{}),N(()=>{u.value=a.getCurrentPosts,c.value=a.getCurrentWinner}),G(()=>{u.value=a.getCurrentPosts,c.value=a.getCurrentWinner}),(n,l)=>(C(),y(Ce,{padding:"",class:"bg-secondary hide-scrollbar"},{default:f(()=>[v(we,{modelValue:s.value,"onUpdate:modelValue":l[0]||(l[0]=_=>s.value=_)},null,8,["modelValue"]),g("div",Fe,[g("div",Je,[Xe,v(Ke,me(he(c.value)),null,16)]),g("div",et,[h.value?(C(),y(je,{key:0})):A("",!0)]),g("div",tt,[h.value?(C(),y(Ge,{key:0})):A("",!0)])]),v(U,{showing:u.value!=null?!t.value:t.value,class:"bg-accent"},{default:f(()=>[v(W,{thickness:10,size:"50px",color:"pithee"})]),_:1},8,["showing"])]),_:1}))}};var lt=I(at,[["__scopeId","data-v-a9cf4904"]]);export{lt as default};
